<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kenta Yoshida" />

<meta name="date" content="2019-11-19" />

<title>Simple Emax model fit with Stan</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Simple Emax model fit with Stan</h1>
<h4 class="author">Kenta Yoshida</h4>
<h4 class="date">2019-11-19</h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstanemax)
<span class="co">#&gt; Warning: package 'Rcpp' was built under R version 3.5.3</span>
<span class="kw">library</span>(dplyr)
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 3.5.3</span>
<span class="kw">library</span>(ggplot2)
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 3.5.3</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>)</code></pre></div>
<p>This vignette provide an overview of the workflow of Emax model analysis using this package.</p>
<div id="typical-workflow" class="section level1">
<h1>Typical workflow</h1>
<div id="model-run-with-stan_emax-function" class="section level2">
<h2>Model run with <code>stan_emax</code> function</h2>
<p><code>stan_emax()</code> is the main function of this package to perform Emax model analysis on the data. This function requires minimum two input arguments - <code>formula</code> and <code>data</code>. In the <code>formula</code> argument, you will specify which columns of <code>data</code> will be used as exposure and response data, in a format similar to <code>stats::lm()</code> function, e.g. <code>response ~ exposure</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(exposure.response.sample)

fit.emax &lt;-<span class="st"> </span><span class="kw">stan_emax</span>(response <span class="op">~</span><span class="st"> </span>exposure, <span class="dt">data =</span> exposure.response.sample,
                      <span class="co"># the next line is only to make the example go fast enough</span>
                      <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span>, <span class="dt">seed =</span> <span class="dv">12345</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.emax
<span class="co">#&gt; ---- Emax model fit with rstanemax ----</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        mean se_mean    sd  2.5%   25%   50%   75%  97.5%  n_eff Rhat</span>
<span class="co">#&gt; emax  92.32    0.31  6.04 81.25 88.17 92.27 96.35 103.96 384.95 1.01</span>
<span class="co">#&gt; e0     5.63    0.22  4.67 -2.97  2.42  5.78  8.85  14.39 444.72 1.01</span>
<span class="co">#&gt; ec50  76.11    0.87 21.05 43.81 61.75 73.35 86.40 124.79 587.83 1.00</span>
<span class="co">#&gt; gamma  1.00     NaN  0.00  1.00  1.00  1.00  1.00   1.00    NaN  NaN</span>
<span class="co">#&gt; sigma 16.65    0.06  1.56 14.12 15.56 16.50 17.48  20.37 656.97 1.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Use `extract_stanfit()` function to extract raw stanfit object</span>
<span class="co">#&gt; * Use `plot()` function to visualize model fit</span>
<span class="co">#&gt; * Use `posterior_predict()` or `posterior_predict_quantile()` function to get</span>
<span class="co">#&gt;   raw predictions or make predictions on new data</span>
<span class="co">#&gt; * Use `extract_obs_mod_frame()` function to extract raw data </span>
<span class="co">#&gt;   in a processed format (useful for plotting)</span></code></pre></div>
<p><code>plot()</code> function shows the estimated Emax model curve with 95% credible intervals of parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fit.emax)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Raw output from <code>rstan</code> is stored in the output variable, and you can access it with <code>extract_stanfit()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="kw">extract_stanfit</span>(fit.emax))
<span class="co">#&gt; [1] &quot;stanfit&quot;</span>
<span class="co">#&gt; attr(,&quot;package&quot;)</span>
<span class="co">#&gt; [1] &quot;rstan&quot;</span></code></pre></div>
</div>
<div id="prediction-of-response-with-new-exposure-data" class="section level2">
<h2>Prediction of response with new exposure data</h2>
<p><code>posterior_predict()</code> function allows users to predict the response using new exposure data. If <code>newdata</code> is not provided, the function returns the prediction on the exposures in original data. The default output is a matrix of posterior predictions, but you can also specify “dataframe” or “tibble” that contain posterior predictions in a long format. See help of <code>rstanemax::posterior_predict()</code> for the description of two predictions, <code>respHat</code> and <code>response</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">response.pred &lt;-<span class="st"> </span><span class="kw">posterior_predict</span>(fit.emax, <span class="dt">newdata =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">1000</span>), <span class="dt">returnType =</span> <span class="st">&quot;tibble&quot;</span>)

response.pred <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(mcmcid, exposure, respHat, response)
<span class="co">#&gt; # A tibble: 3,000 x 4</span>
<span class="co">#&gt;    mcmcid exposure respHat response</span>
<span class="co">#&gt;     &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1      1        0    5.89    -7.17</span>
<span class="co">#&gt;  2      1      100   52.0     57.7 </span>
<span class="co">#&gt;  3      1     1000   86.9     91.8 </span>
<span class="co">#&gt;  4      2        0   -4.11   -22.1 </span>
<span class="co">#&gt;  5      2      100   61.8     57.0 </span>
<span class="co">#&gt;  6      2     1000   93.0     73.2 </span>
<span class="co">#&gt;  7      3        0   -4.90   -50.4 </span>
<span class="co">#&gt;  8      3      100   66.2     55.4 </span>
<span class="co">#&gt;  9      3     1000  100.     109.  </span>
<span class="co">#&gt; 10      4        0    5.95   -10.7 </span>
<span class="co">#&gt; # ... with 2,990 more rows</span></code></pre></div>
<p>You can also get quantiles of predictions with <code>posterior_predict_quantile()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resp.pred.quantile &lt;-<span class="st"> </span><span class="kw">posterior_predict_quantile</span>(fit.emax, <span class="dt">newdata =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="dt">by =</span> <span class="dv">100</span>))
resp.pred.quantile
<span class="co">#&gt; # A tibble: 51 x 11</span>
<span class="co">#&gt;    exposure covemax covec50 cove0 Covariates ci_low ci_med ci_high pi_low pi_med</span>
<span class="co">#&gt;       &lt;dbl&gt; &lt;fct&gt;   &lt;fct&gt;   &lt;fct&gt; &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1        0 1       1       1     &quot;&quot;          -2.09   5.78    13.0  -22.8   6.60</span>
<span class="co">#&gt;  2      100 1       1       1     &quot;&quot;          52.3   58.8     64.5   30.4  59.5 </span>
<span class="co">#&gt;  3      200 1       1       1     &quot;&quot;          67.8   72.9     77.7   45.3  72.9 </span>
<span class="co">#&gt;  4      300 1       1       1     &quot;&quot;          75.0   79.5     84.2   52.9  79.0 </span>
<span class="co">#&gt;  5      400 1       1       1     &quot;&quot;          78.8   83.4     88.1   56.7  83.2 </span>
<span class="co">#&gt;  6      500 1       1       1     &quot;&quot;          81.2   85.9     90.6   60.3  87.0 </span>
<span class="co">#&gt;  7      600 1       1       1     &quot;&quot;          82.6   87.6     92.6   57.5  87.2 </span>
<span class="co">#&gt;  8      700 1       1       1     &quot;&quot;          83.7   88.9     94.1   61.5  89.3 </span>
<span class="co">#&gt;  9      800 1       1       1     &quot;&quot;          84.6   89.9     95.4   63.2  89.9 </span>
<span class="co">#&gt; 10      900 1       1       1     &quot;&quot;          85.2   90.7     96.4   60.5  90.3 </span>
<span class="co">#&gt; # ... with 41 more rows, and 1 more variable: pi_high &lt;dbl&gt;</span></code></pre></div>
<p>Input data can be obtained in a same format with <code>extract_obs_mod_frame()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obs.formatted &lt;-<span class="st"> </span><span class="kw">extract_obs_mod_frame</span>(fit.emax)</code></pre></div>
<p>These are particularly useful when you want to plot the estimated Emax curve.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(resp.pred.quantile, <span class="kw">aes</span>(exposure, ci_med)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>ci_low, <span class="dt">ymax=</span>ci_high), <span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>pi_low, <span class="dt">ymax=</span>pi_high), <span class="dt">alpha =</span> .<span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> obs.formatted,
             <span class="kw">aes</span>(<span class="dt">y =</span> response)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;response&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="fix-parameter-values-in-emax-model" class="section level1">
<h1>Fix parameter values in Emax model</h1>
<p>You can fix parameter values in Emax model for E0 and/or gamma (Hill coefficient). See help of <code>stan_emax()</code> for the details. The default is to fix gamma at 1 and to estimate E0 from data.</p>
<p>Below is the example of estimating gamma from data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(exposure.response.sample)

fit.emax.sigmoidal &lt;-<span class="st"> </span><span class="kw">stan_emax</span>(response <span class="op">~</span><span class="st"> </span>exposure, <span class="dt">data =</span> exposure.response.sample, <span class="dt">gamma.fix =</span> <span class="ot">NULL</span>,
                                <span class="co"># the next line is only to make the example go fast enough</span>
                                <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span>, <span class="dt">seed =</span> <span class="dv">12345</span>)
<span class="co">#&gt; Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="co">#&gt; Running the chains for more iterations may help. See</span>
<span class="co">#&gt; http://mc-stan.org/misc/warnings.html#tail-ess</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.emax.sigmoidal
<span class="co">#&gt; ---- Emax model fit with rstanemax ----</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        mean se_mean    sd  2.5%   25%   50%   75%  97.5%  n_eff Rhat</span>
<span class="co">#&gt; emax  91.77    0.99 12.29 73.44 84.14 89.72 96.48 123.18 154.54 1.00</span>
<span class="co">#&gt; e0     6.43    0.23  4.94 -3.17  3.00  6.52  9.50  15.63 446.65 1.00</span>
<span class="co">#&gt; ec50  83.26    3.79 46.60 44.55 61.03 72.14 87.97 223.54 151.51 1.01</span>
<span class="co">#&gt; gamma  1.12    0.02  0.34  0.53  0.90  1.09  1.31   1.88 322.49 1.00</span>
<span class="co">#&gt; sigma 16.74    0.06  1.66 13.93 15.56 16.60 17.73  20.31 735.46 1.00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Use `extract_stanfit()` function to extract raw stanfit object</span>
<span class="co">#&gt; * Use `plot()` function to visualize model fit</span>
<span class="co">#&gt; * Use `posterior_predict()` or `posterior_predict_quantile()` function to get</span>
<span class="co">#&gt;   raw predictions or make predictions on new data</span>
<span class="co">#&gt; * Use `extract_obs_mod_frame()` function to extract raw data </span>
<span class="co">#&gt;   in a processed format (useful for plotting)</span></code></pre></div>
<p>You can compare the difference of posterior predictions between two models (in this case they are very close to each other):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
exposure_pred &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(exposure.response.sample<span class="op">$</span>exposure),
                     <span class="kw">max</span>(exposure.response.sample<span class="op">$</span>exposure),
                     <span class="dt">length.out =</span> <span class="dv">100</span>)

pred1 &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">posterior_predict_quantile</span>(fit.emax, exposure_pred) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="st">&quot;Emax&quot;</span>)
pred2 &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">posterior_predict_quantile</span>(fit.emax.sigmoidal, exposure_pred) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="st">&quot;Sigmoidal Emax&quot;</span>)

pred &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(pred1, pred2)


<span class="kw">ggplot</span>(pred, <span class="kw">aes</span>(exposure, ci_med, <span class="dt">color =</span> model, <span class="dt">fill =</span> model)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>ci_low, <span class="dt">ymax=</span>ci_high), <span class="dt">alpha =</span> .<span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>pi_low, <span class="dt">ymax=</span>pi_high), <span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="dt">color =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>exposure.response.sample, <span class="kw">aes</span>(exposure, response), 
             <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;response&quot;</span>)



 </code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="set-covariates" class="section level1">
<h1>Set covariates</h1>
<p>You can specify categorical covariates for Emax, EC50, and E0. See help of <code>stan_emax()</code> for the details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(exposure.response.sample.test)

test.data &lt;-
<span class="st">  </span><span class="kw">mutate</span>(exposure.response.sample.test,
         <span class="dt">SEX =</span> <span class="kw">ifelse</span>(cov2 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;MALE&quot;</span>, <span class="st">&quot;FEMALE&quot;</span>))

fit.cov &lt;-<span class="st"> </span><span class="kw">stan_emax</span>(<span class="dt">formula =</span> resp <span class="op">~</span><span class="st"> </span>conc, <span class="dt">data =</span> test.data,
                     <span class="dt">param.cov =</span> <span class="kw">list</span>(<span class="dt">emax =</span> <span class="st">&quot;SEX&quot;</span>),
                     <span class="co"># the next line is only to make the example go fast enough</span>
                     <span class="dt">chains =</span> <span class="dv">2</span>, <span class="dt">iter =</span> <span class="dv">1000</span>, <span class="dt">seed =</span> <span class="dv">12345</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.cov
<span class="co">#&gt; ---- Emax model fit with rstanemax ----</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                mean se_mean    sd  2.5%   25%    50%    75%  97.5%  n_eff Rhat</span>
<span class="co">#&gt; emax[FEMALE]  81.34    0.15  3.89 73.91 78.82  81.13  83.78  89.05 651.49    1</span>
<span class="co">#&gt; emax[MALE]    87.66    0.20  5.00 78.19 84.22  87.72  91.15  97.42 621.72    1</span>
<span class="co">#&gt; e0            15.07    0.09  2.35 10.30 13.51  15.13  16.70  19.32 638.51    1</span>
<span class="co">#&gt; ec50         106.28    0.74 20.07 70.69 93.03 104.42 116.83 150.64 740.38    1</span>
<span class="co">#&gt; gamma          1.00     NaN  0.00  1.00  1.00   1.00   1.00   1.00    NaN  NaN</span>
<span class="co">#&gt; sigma         10.53    0.04  1.06  8.77  9.80  10.42  11.16  12.82 573.60    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Use `extract_stanfit()` function to extract raw stanfit object</span>
<span class="co">#&gt; * Use `plot()` function to visualize model fit</span>
<span class="co">#&gt; * Use `posterior_predict()` or `posterior_predict_quantile()` function to get</span>
<span class="co">#&gt;   raw predictions or make predictions on new data</span>
<span class="co">#&gt; * Use `extract_obs_mod_frame()` function to extract raw data </span>
<span class="co">#&gt;   in a processed format (useful for plotting)</span>
<span class="kw">plot</span>(fit.cov)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
